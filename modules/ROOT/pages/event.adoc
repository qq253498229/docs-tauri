= event

https://tauri.app/zh-cn/v1/api/js/event[原文地址]

事件系统允许你向后端发送事件，或者是监听来自后端的事件。

当在 tauri.conf.json 中设置 `xref:configuration.adoc#build-config[build.withGlobalTauri]` 为 `true` 时，该包也可以通过 `pass:[window.__TAURI__.event]` 访问。

[[enumerations]]
== Enumerations

[[tauri-event]]
=== TauriEvent

Since: 1.1.0

枚举成员

[%autowidth]
|===
|名称|类型|定义在
|`CHECK_UPDATE`|`"tauri://update"`|{event_url}event.ts#L34[event.ts:34]
|`DOWNLOAD_PROGRESS`|`"tauri://update-download-progress"`|{event_url}event.ts#L38[event.ts:38]
|`INSTALL_UPDATE`|`"tauri://update-install"`|{event_url}event.ts#L36[event.ts:36]
|`MENU`|`"tauri://menu"`|{event_url}event.ts#L33[event.ts:33]
|`STATUS_UPDATE`|`"tauri://update-status"`|{event_url}event.ts#L37[event.ts:37]
|`UPDATE_AVAILABLE`|`"tauri://update-available"`|{event_url}event.ts#L35[event.ts:35]
|`WINDOW_BLUR`|`"tauri://blur"`|{event_url}event.ts#L27[event.ts:27]
|`WINDOW_CLOSE_REQUESTED`|`"tauri://close-requested"`|{event_url}event.ts#L23[event.ts:23]
|`WINDOW_CREATED`|`"tauri://window-created"`|{event_url}event.ts#L24[event.ts:24]
|`WINDOW_DESTROYED`|`"tauri://destroyed"`|{event_url}event.ts#L25[event.ts:25]
|`WINDOW_FILE_DROP`|`"tauri://file-drop"`|{event_url}event.ts#L30[event.ts:30]
|`WINDOW_FILE_DROP_CANCELLED`|`"tauri://file-drop-cancelled"`|{event_url}event.ts#L32[event.ts:32]
|`WINDOW_FILE_DROP_HOVER`|`"tauri://file-drop-hover"`|{event_url}event.ts#L31[event.ts:31]
|`WINDOW_FOCUS`|`"tauri://focus"`|{event_url}event.ts#L26[event.ts:26]
|`WINDOW_MOVED`|`"tauri://move"`|{event_url}event.ts#L22[event.ts:22]
|`WINDOW_RESIZED`|`"tauri://resize"`|{event_url}event.ts#L21[event.ts:21]
|`WINDOW_SCALE_FACTOR_CHANGED`|`"tauri://scale-change"`|{event_url}event.ts#L28[event.ts:28]
|`WINDOW_THEME_CHANGED`|`"tauri://theme-changed"`|{event_url}event.ts#L29[event.ts:29]
|===

[[interfaces]]
== Interfaces

[[event]]
=== Event<T>

类型参数

- `T`

属性

- event: `<<event-name,EventName>>`

事件名称。

*定义在*: {event_url}helpers/event.ts#L12[helpers/event.ts:12]

- id: `number`

用来取消监听的事件唯一标识符。

*定义在*: {event_url}helpers/event.ts#L16[helpers/event.ts:16]

- payload: `T`

事件消息体

*定义在*: {event_url}helpers/event.ts#L18[helpers/event.ts:18]

- windowLabel: `string`

发出此事件的窗口的标签。

*定义在*: {event_url}helpers/event.ts#L14[helpers/event.ts:14]

[[type-aliases]]
== Type Aliases

[[event-callback]]
=== EventCallback<T>

- EventCallback<``T``>: (`event`: `<<event,Event>>`<``T``>) => `void`

类型参数

- `T`

类型声明

- (`event`: `<<event,Event>>`<``T``>): `void`

参数

[%autowidth]
|===
|名称|类型
|`event`|`<<event,Event>>`<``T``>
|===

*返回*: `void`

*定义在*: {event_url}helpers/event.ts#L21[helpers/event.ts:21]

[[event-name]]
=== EventName

- EventName: `$\{TauriEvent}` | `string` & `link:https://www.typescriptlang.org/docs/handbook/utility-types.html#recordkeys-type[Record]`<``never``, `never`>

*定义在*: {event_url}event.ts#L15[event.ts:15]

[[unlisten-fn]]
=== UnlistenFn

- UnlistenFn: () => `void`

类型声明

- (): `void`

*返回*: `void`

*定义在*: {event_url}helpers/event.ts#L23[helpers/event.ts:23]

[[functions]]
== Functions

[[emit]]
=== emit

- emit(`event`: `string`, `payload?`: `unknown`): `link:{promise_url}[Promise]`<``void``>

向后端发送一个事件。

示例

[source,typescript]
----
import { emit } from '@tauri-apps/api/event';
await emit('frontend-loaded', { loggedIn: true, token: 'authToken' });
----

Since: 1.0.0

参数

[%autowidth]
|===
|名称|类型|描述
|`event`|`string`|事件名称。只能包含字母、数字、`-`、`/`、`:` 和 `_`。
|`payload?`|`unknown`|-
|===

*返回*: `link:{promise_url}[Promise]`<``void``>

[[listen]]
=== listen

- listen<``T``>(`event`: `<<event-name,EventName>>`, `handler`: `<<event-callback,EventCallback>>`<``T``>): `link:{promise_url}[Promise]`<``<<unlisten-fn,UnlistenFn>>``>

监听来自后端的事件。

示例

[source,typescript]
----
import { listen } from '@tauri-apps/api/event';
const unlisten = await listen<string>('error', (event) => {
  console.log(`Got error in window ${event.windowLabel}, payload: ${event.payload}`);
});

// you need to call unlisten if your handler goes out of scope e.g. the component is unmounted
unlisten();
----

Since: 1.0.0

类型参数

- `T`

参数

[%autowidth]
|===
|名称|类型|描述
|`event`|`<<event-name,EventName>>`|事件名称。只能包含字母、数字、`-`、`/`、`:` 和 `_`。
|`handler`|`<<event-callback,EventCallback>>`<``T``>|事件回调句柄。
|===

*返回*: `link:{promise_url}[Promise]`<``<<unlisten-fn,UnlistenFn>>``>

一个 Promise，解析为一个函数，用于取消事件监听。请注意，如果你的监听器超出作用域，例如组件卸载，必须移除监听器。

[[once]]
=== once

- once<``T``>(`event`: `<<event-name,EventName>>`, `handler`: `<<event-callback,EventCallback>>`<``T``>): `link:{promise_url}[Promise]`<``<<unlisten-fn,UnlistenFn>>``>

监听来自后端的一次性事件。

示例

[source,typescript]
----
import { once } from '@tauri-apps/api/event';
interface LoadedPayload {
  loggedIn: boolean,
  token: string
}
const unlisten = await once<LoadedPayload>('loaded', (event) => {
  console.log(`App is loaded, loggedIn: ${event.payload.loggedIn}, token: ${event.payload.token}`);
});

// you need to call unlisten if your handler goes out of scope e.g. the component is unmounted
unlisten();
----

Since: 1.0.0

类型参数

- `T`

参数

[%autowidth]
|===
|名称|类型|描述
|`event`|`<<event-name,EventName>>`|事件名称。只能包含字母、数字、`-`、`/`、`:` 和 `_`。
|`handler`|`<<event-callback,EventCallback>>`<``T``>|-
|===

*返回*: `link:{promise_url}[Promise]`<``<<unlisten-fn,UnlistenFn>>``>

一个 Promise，解析为一个函数，用于取消事件监听。请注意，如果你的监听器超出作用域，例如组件卸载，必须移除监听器。
